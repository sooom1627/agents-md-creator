

# 全体フロー

```
[ランディング] 
    ↓
[テンプレート選択] ← ここで大まかな方向性を決める
    ↓
[ウィザード入力]
    ├─ Step 1: プロジェクト基本情報
    ├─ Step 2: AIの役割
    ├─ Step 3: 技術スタック
    ├─ Step 4: コーディング哲学
    ├─ Step 5: 禁止事項
    └─ Step 6: 開発フロー
    ↓
[プレビュー & 調整]
    ↓
[エクスポート]
```

---

# 詳細機能要件

---

## 📍 Phase 0: ランディングページ

### 4.1 目的
「このツールは何をしてくれるのか」を3秒で理解させる

### 4.2 コンテンツ

#### ヒーローセクション
```

[CTAボタン]
→ テンプレートから始める (Primary)
→ ゼロから作る (Secondary)
```

#### 実例プレビュー
「生成されるファイルのサンプル」をコードブロックで表示
→ 「こういうものが作れる」というイメージを持たせる

---

## 📍 Phase 1: テンプレート選択

### 4.3 目的
プロジェクトタイプに応じた「80%完成」のスタート地点を提供

### 4.4 UI設計

#### レイアウト
```
┌─────────────────────────────────────┐
│ あなたのプロジェクトに近いものは？      │
│ ※後で細かく調整できます               │
├─────────────────────────────────────┤
│  [カード1]  [カード2]  [カード3]      │
│  [カード4]  [カード5]  [カード6]      │
│                                     │
│  [スキップして空白から始める]          │
└─────────────────────────────────────┘
```

#### テンプレートカード（6種類）

各カードには以下の要素:
- **ビジュアルアイコン**（絵文字 + カラー背景）
- **テンプレート名**
- **簡潔な説明**（1行）
- **"Popular" バッジ**（人気のものに）
- **ホバーで詳細表示**（含まれる技術スタックのアイコンリスト）

##### スキップオプション
```
[リンクボタン]
→ テンプレートを使わず、空白から作成する
```
---

## 📍 Phase 2: ウィザード入力

### 4.5 共通UI設計

#### 画面レイアウト（デスクトップ）
```
┌────────────────────────────────────────────┐
│ [Logo]  Step 2/6: AIの役割                  │  ← ヘッダー（固定）
│ ━━━━━━━━━━━━━●━━━━━━━━━━━━━━━━━━━━━━━━━  │  ← プログレスバー
├─────────────────┬──────────────────────────┤
│                 │                          │
│  [入力エリア]    │   [プレビューエリア]       │
│                 │                          │
│  各Stepの       │   生成される              │
│  フォーム要素    │   Markdownが             │
│                 │   リアルタイム表示        │
│                 │                          │
│                 │   (シンタックス           │
│                 │    ハイライト付き)        │
│                 │                          │
├─────────────────┴──────────────────────────┤
│  [← 戻る]              [次へ →]             │  ← フッター（固定）
└────────────────────────────────────────────┘
```

#### モバイルレイアウト
- タブ切り替え式: 「入力」「プレビュー」を切り替え
- フローティングボタンでプレビューを表示

---

### 🔷 Step 1: プロジェクト基本情報

#### 入力項目

##### 1. プロジェクト名
```
[テキスト入力]
例: my-saas-app
```

**Tips（アイコン💡付き）**:
> GitHubのリポジトリ名と同じにしておくと管理しやすいです

##### 2. プロジェクトの目的（1行）
```
[テキストエリア（1行）]
例: 中小企業向けの請求書管理SaaS
```

**Tips**:
> AIがコードを書く時の「方向性」を理解するために重要です

##### 3. 開発フェーズ
```
[ラジオボタン（カード式）]

○ 🆕 新規開発
   ゼロから立ち上げるプロジェクト
   
○ ➕ 機能追加
   既存システムに新しい機能を実装
   
○ 🔄 リファクタリング
   コードの整理や技術スタックの更新
   
○ 🛠️ 保守・運用
   バグ修正や小さな改善が中心
```

**アコーディオン: なぜフェーズが重要？**
> 新規開発では「ベストプラクティス」を優先し、既存システムでは「整合性」を優先するなど、AIの判断基準が変わります。

---

### 🔷 Step 2: AIの役割

#### 目的表示
```
[インフォボックス]
💡 AIに「どんなエンジニアとして振る舞って欲しいか」を伝えます
```

#### 入力項目

##### プリセットから選択

**UI**: カード式選択（複数選択可、主要なもの1つを推奨）

| カード | 内容 |
|-------|------|
| **🎯 フルスタック重視** | フロントエンドからバックエンドまで一貫した設計 |
| **🎨 UI/UX スペシャリスト** | 使いやすさとデザインを最優先 |
| **🔒 セキュリティ第一** | 認証・認可・データ保護を徹底 |
| **⚡ パフォーマンス最適化** | 速度とスケーラビリティを重視 |
| **📚 ドキュメンテーション** | コードの可読性とコメントを徹底 |
| **🧪 テスト駆動開発** | 自動テストを常に書く |

**各カードにホバー時の詳細説明**:
例: 「🎯 フルスタック重視」
```
[ツールチップ]
こんな時に選ぶ:
・フロント/バック両方を触るプロジェクト
・APIとUIの整合性を保ちたい
・チーム人数が少なく、幅広く対応が必要

生成される指示の例:
"You are a senior full-stack engineer who considers 
both frontend UX and backend architecture..."
```

##### カスタム記述（オプション）
```
[テキストエリア（折りたたみ可能）]
▼ さらに細かく指定する（上級者向け）

例: 
「あなたはNext.jsのApp Routerに精通し、
React Server Componentsを最大限活用する
シニアエンジニアです」
```

**アコーディオン: 良い役割定義の例**
```
✅ 良い例:
"You are a senior TypeScript engineer who prioritizes 
type safety and follows functional programming patterns."

❌ 悪い例:
"You are a good developer."
→ 抽象的すぎて、AIの行動が変わりません
```

**外部リンク**:
> 📖 [GitHub公式: 効果的な役割定義の書き方](https://github.blog/...)

---

### 🔷 Step 3: 技術スタック

#### UI設計: カテゴリ別タブ + ビジュアル選択

```
┌─────────────────────────────────────┐
│ [Frontend] [Backend] [Database]     │  ← タブ
│ [Styling] [Testing] [Tools]         │
├─────────────────────────────────────┤
│                                     │
│  [アイコン付きカード群]              │
│                                     │
└─────────────────────────────────────┘
```

#### Frontend タブの例

**選択UI**: チェックボックス式カード（複数選択可）

| カード | 説明 | Popular バッジ |
|-------|------|---------------|
| ⚛️ **React** | UIライブラリのデファクトスタンダード | ⭐ |
| ▲ **Next.js** | React × SSR/SSG の統合フレームワーク | ⭐ |
| 💚 **Vue.js** | シンプルで学習コストが低い |  |
| 🔥 **Svelte** | コンパイラベースで高速 |  |
| ⚡ **Vite** | 高速ビルドツール | ⭐ |

**各カードの構造**:
```
┌──────────────────────┐
│  [アイコン]           │
│  技術名               │
│  簡潔な説明（1行）     │
│                      │
│  [i] ← ホバーで詳細  │
└──────────────────────┘
```

**ホバー詳細（ツールチップ）**:
```
▲ Next.js

こんな時に選ぶ:
・SEOが重要なサイト（ブログ、EC）
・サーバーとクライアントを統合管理したい
・App Routerで最新のReact機能を使いたい

agents.mdでの記載例:
"Use Next.js 15 App Router with React Server 
Components as default"
```

#### バージョン指定（オプション）

各技術にバージョン入力欄（デフォルトは空欄）
```
Next.js [15 ▼]  ← ドロップダウンでメジャーバージョン
```

**Tips**:
> バージョンを指定すると、AIが古い書き方を避けてくれます

#### Backend, Database, Styling, Testing, Tools タブ

同様の構造で、各カテゴリの主要技術を表示

**Backend**:
- Node.js + Express
- Next.js API Routes
- Python + FastAPI
- Go
- その他

**Database**:
- PostgreSQL
- MySQL
- MongoDB
- Supabase
- Prisma (ORM)
- Drizzle (ORM)

**Styling**:
- Tailwind CSS ⭐
- CSS Modules
- Styled Components
- shadcn/ui ⭐
- その他

**Testing**:
- Jest
- Vitest ⭐
- Playwright ⭐
- Cypress
- Testing Library

**Tools**:
- TypeScript ⭐
- ESLint
- Prettier
- Husky (Git Hooks)
- Turborepo (Monorepo)

#### 「その他」入力欄
```
[テキスト入力]
上記にない技術を追加:
例: Zod, React Hook Form, Framer Motion
```

**アコーディオン: 技術スタックの書き方のコツ**
```
💡 多すぎると混乱するので、コアな5-8個に絞るのがおすすめ

✅ 優先度をつける:
- 必須: Next.js, TypeScript, Prisma
- 推奨: Tailwind, Zod
- オプション: Storybook

❌ 避ける:
npm installされている全てのパッケージを列挙する
→ AIが何を優先すべきか分からなくなります
```

---

### 🔷 Step 4: コーディング哲学

#### 目的表示
```
[インフォボックス]
💡 「こう書いてほしい」というスタイルや原則を伝えます
```

#### UI: プリセット + カスタムの組み合わせ

##### カテゴリ1: アーキテクチャパターン

**選択UI**: ラジオボタン（1つ選択）

```
○ Server Components優先（Next.js推奨）
  └ 説明: できる限りサーバー側でレンダリングし、
          クライアントJSを最小化

○ Client-Side Rendering
  └ 説明: SPAスタイルで、ブラウザ側で動的に構築

○ 特に指定しない
```

**アコーディオン詳細**:
> 📖 Server Components とは？
> Next.js 13以降で導入された、サーバー側でReactコンポーネントを
> 実行する仕組み。SEOやパフォーマンスに有利。
> [公式ドキュメント](https://nextjs.org/docs/app/...)

##### カテゴリ2: TypeScript

```
☑ Strict モード必須
  └ any型を禁止し、型安全性を最大化

☑ 型定義は別ファイル（types.ts）に分離
```

##### カテゴリ3: エクスポートスタイル

```
○ Named Export のみ（推奨）
  └ import { Button } from './Button'
  
○ Default Export を許可
  └ import Button from './Button'
  
○ 特に指定しない
```

**Tips**:
> Named Exportの方が、エディタの補完やリファクタリングがしやすいです

##### カテゴリ4: コンポーネント設計

**複数選択可能**:
```
☑ Functional Component + Hooks
☑ Props は interface で定義
☑ 1ファイル1コンポーネント
☑ ディレクトリごとに index.ts でまとめてexport
```

##### カテゴリ5: エラーハンドリング

```
○ try-catch を使う
○ .catch() メソッドを使う
○ 特に指定しない
```

##### カテゴリ6: コメント・ドキュメント

```
☑ 関数には JSDoc コメントを書く
☑ 複雑なロジックには説明コメント必須
☑ README.md を常に最新に保つ
```

#### カスタムルール追加

```
[テキストエリア]
▼ 独自のルールを追加

例:
- すべてのAPIレスポンスは Result<T, Error> 型で返す
- 状態管理は Zustand を使用し、Redux は使わない
- CSSは Tailwind のみで、inline style は禁止
```

**アコーディオン: 良いルールの書き方**
```
✅ 具体的:
"Use Server Actions for form submissions"

❌ 抽象的:
"Write clean code"
→ AIには何をすべきか伝わりません
```

---

### 🔷 Step 5: 禁止事項（Guardrails）

#### 目的表示
```
[警告ボックス（黄色背景）]
🚫 AIに「やってはいけないこと」を明確に伝えます
```

#### UI: チェックボックス式（複数選択）

##### 型安全性
```
☑ any 型を使わない
☑ @ts-ignore を使わない
```

##### パッケージ管理
```
☑ 新しいパッケージは勝手にインストールしない
  └ 説明: 依存関係が増えすぎるのを防ぐため、事前確認必須
```

##### スタイリング
```
☑ inline style を使わない
☑ CSS-in-JS ライブラリを使わない（Tailwind のみ）
```

##### データベース
```
☑ マイグレーションを手動で編集しない
☑ 本番DBに直接クエリを実行しない
```

##### セキュリティ
```
☑ 環境変数をコードにハードコードしない
☑ ユーザー入力を検証なしで使わない
```

##### その他
```
☑ console.log をコミットしない
☑ コメントアウトされたコードを残さない
```

#### カスタム禁止事項
```
[テキストエリア]
▼ プロジェクト固有の禁止事項

例:
- useEffect の依存配列を空にしない
- 外部APIは必ずエラーハンドリングを実装
- 認証なしでAPIエンドポイントを作らない
```

**アコーディオン: 禁止事項が効果的な理由**
```
💡 AIは「できること」は得意ですが、
  「やってはいけないこと」も明示すると精度が上がります

例: 
「any型を使わない」と書くことで、
AIは代わりに unknown 型や適切な型定義を提案します
```

**外部リンク**:
> 📖 [GitHub: 2500リポジトリから学ぶGuardrails](https://github.blog/...)

---

### 🔷 Step 6: 開発フロー

#### 目的表示
```
[インフォボックス]
💡 日常的に使うコマンドやワークフローを登録します
```

#### 入力項目

##### 1. よく使うコマンド

**UI**: フォーム式（デフォルト値あり）

```
開発サーバー起動
[npm run dev          ]

テスト実行
[npm test             ]

ビルド
[npm run build        ]

型チェック
[npm run type-check   ]

Lint実行
[npm run lint         ]

▼ コマンドを追加
```

**Tips**:
> AIが「サーバーを起動して」と言われた時、
> 正確なコマンドを実行できます

##### 2. Git ブランチ戦略

```
○ GitHub Flow（シンプル）
  └ main ブランチ + feature ブランチ
  
○ Git Flow（厳格）
  └ main, develop, feature, release, hotfix
  
○ Trunk-Based Development
  └ 常に main にマージ
  
○ 特に指定しない
```

**アコーディオン: どれを選ぶ？**
```
GitHub Flow: 小規模チーム、リリース頻度高い
Git Flow: 大規模、リリースサイクルが決まっている
Trunk-Based: CI/CDが充実、自動テストが完備
```

##### 3. Definition of Done（完了の定義）

**複数選択可能**:
```
☑ すべてのテストがパス
☑ TypeScript の型エラーがゼロ
☑ ESLint / Prettier でフォーマット済み
☑ コードレビュー完了
☑ ドキュメント更新済み
☑ 本番環境で動作確認済み
```

**カスタム追加**:
```
[テキストエリア]
例:
- Lighthouse スコア 90点以上
- アクセシビリティチェック完了
```

---

## 📍 Phase 3: プレビュー & 調整

### 4.6 プレビュー画面の設計

#### レイアウト
```
┌────────────────────────────────────────────┐
│ 完成！ agents.md が生成されました 🎉        │
├────────────────────────────────────────────┤
│                                            │
│  [生成されたMarkdownをフルスクリーン表示]   │
│  （シンタックスハイライト + 行番号）         │
│                                            │
│  ※スクロールして全体を確認できる            │
│                                            │
├────────────────────────────────────────────┤
│  [📋 コピー] [💾 ダウンロード] [✏️ 編集] │
└────────────────────────────────────────────┘
```

#### インタラクション

##### 1. クイックコピー
```
[ボタン]
📋 クリップボードにコピー

クリック後 → ボタンが「✅ コピーしました」に変化（2秒間）
```

##### 2. ファイル形式選択
```
[ドロップダウン]
💾 ダウンロード ▼

選択肢:
- agents.md（GitHub Copilot標準）
- .cursorrules（Cursor用）
- INSTRUCTIONS.md（Windsurf用）
```

##### 3. 編集モード
```
[ボタン]
✏️ 手動で調整する

→ テキストエリアに切り替わり、直接編集可能
→ 編集後、再度プレビューに戻れる
```
## 📍 Phase 4: エクスポート完了

### 完了画面

```
┌────────────────────────────────────────────┐
│           ✅ ダウンロード完了！             │
├────────────────────────────────────────────┤
│                                            │
│  次にやること:                              │
│                                            │
│  1️⃣ プロジェクトのルートに配置             │
│     agents.md をリポジトリのトップに置く    │
│                                            │
│  2️⃣ AIエージェントで開く                   │
│     GitHub Copilot / Cursor / Windsurf    │
│                                            │
│  3️⃣ 動作確認                              │
│     AIに「このプロジェクトの構成を教えて」  │
│     と聞いてみる                           │
│                                            │
│  📖 詳しい使い方を見る                     │
│                                            │
├────────────────────────────────────────────┤
│  [新しく作成] [フィードバックを送る]        │
└────────────────────────────────────────────┘
```

---

## 5. リアルタイムプレビューの仕様

### 5.1 プレビューエリアの動作

#### 更新タイミング
- **デバウンス**: 入力後500msで自動更新
- **即時反映**: チェックボックスやラジオボタンは即座に反映

#### 表示内容
```markdown
# Project: [入力されたプロジェクト名]

## Role
[選択されたペルソナ or カスタム記述]

## Tech Stack
- **Frontend**: [選択された技術をリスト]
- **Backend**: [選択された技術]
...

## Coding Standards
### Preferred Patterns
- [チェックされたルール]

### Avoid
- [禁止事項]

## Development Workflow
...
```

#### ビジュアルフィードバック

**未入力セクション**:
```markdown
## Tech Stack
[⚠️ まだ選択されていません]
```

**入力済みセクション**:
```markdown
## Tech Stack
- Frontend: React, Next.js 15
- Styling: Tailwind CSS
...
```

### 5.2 セクションジャンプ機能

プレビューエリアの各見出しをクリック
→ 対応する入力ステップにスクロール

```
[プレビュー]
# Project: my-app
   ↑ クリック
   ↓
[入力エリアがStep 1にスクロール]
```

---




##  生成されるagents.mdの最終フォーマット

### 7.1 標準テンプレート

```markdown
# Project: [プロジェクト名]

> [プロジェクトの目的 - 1行]

## Role

You are a [選択されたペルソナ]. [カスタム記述があれば追記]

Your primary focus:
- [ペルソナに応じた箇条書き]

## Tech Stack

- **Frontend**: [選択された技術]
- **Backend**: [選択された技術]
- **Database**: [選択された技術]
- **Styling**: [選択された技術]
- **Testing**: [選択された技術]
- **Tools**: [選択された技術]

## Project Structure

[※ユーザーが入力した場合のみ表示]

```
src/
├── app/
│   ├── (auth)/
│   └── api/
├── components/
└── lib/
```

## Coding Standards

### Architecture
[選択されたアーキテクチャパターン]

### TypeScript
[選択されたTypeScriptルール]

### Component Design
[選択されたコンポーネント設計ルール]

### Preferred Patterns
- [チェックされたルール1]
- [チェックされたルール2]

## Constraints (DO NOT)

- [禁止事項1]
- [禁止事項2]

## Development Workflow

### Commands
- **Start dev**: `[コマンド]`
- **Run tests**: `[コマンド]`
- **Build**: `[コマンド]`

### Git Strategy
[選択されたブランチ戦略]

### Definition of Done
- [ ] [チェック項目1]
- [ ] [チェック項目2]

## Current Context

[※任意入力があれば表示]

**Status**: [現在の状況]
**Next Task**: [次のタスク]
**Known Issues**: [既知の問題]

---

*Generated by Agents.md Master Generator*
```
